From ef3343c40b91960ef8ffb0930ae29eae85a3b72d Mon Sep 17 00:00:00 2001
From: Jason Andryuk <jandryuk@gmail.com>
Date: Tue, 24 Sep 2019 14:15:50 -0400
Subject: [PATCH 24/26] oxt: flask: Trim manage_domain

OpenXT doesn't use these permissions
---
 tools/flask/policy/modules/xen.if | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)

diff --git a/tools/flask/policy/modules/xen.if b/tools/flask/policy/modules/xen.if
index 747ac7b71a..11395c61f6 100644
--- a/tools/flask/policy/modules/xen.if
+++ b/tools/flask/policy/modules/xen.if
@@ -84,9 +84,7 @@ define(`create_domain_build_label', `
 define(`manage_domain', `
 	allow $1 $2:domain { getdomaininfo getvcpuinfo getaffinity
 			getaddrsize pause unpause trigger shutdown destroy
-			setaffinity setdomainmaxmem getscheduler resume
-			setpodtarget getpodtarget };
-    allow $1 $2:domain2 set_vnumainfo;
+			setaffinity setdomainmaxmem getscheduler };
 ')
 
 # migrate_domain_out(priv, target)
-- 
2.21.0

