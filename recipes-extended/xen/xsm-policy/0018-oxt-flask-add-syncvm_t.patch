From 4f7e63a87bfcceac277b5e3a1d9d6ecff1fbc69e Mon Sep 17 00:00:00 2001
From: Jason Andryuk <jandryuk@gmail.com>
Date: Fri, 20 Sep 2019 10:38:22 -0400
Subject: [PATCH 18/26] oxt: flask: add syncvm_t

Add syncvm_t for the Synchronizer Virtual Machine.

Signed-off-by: Jason Andryuk <jandryuk@gmail.com>
---
 tools/flask/policy/modules/modules.conf |  2 ++
 tools/flask/policy/modules/syncvm.te    | 10 ++++++++++
 2 files changed, 12 insertions(+)
 create mode 100644 tools/flask/policy/modules/syncvm.te

diff --git a/tools/flask/policy/modules/modules.conf b/tools/flask/policy/modules/modules.conf
index 415378cf85..980d1edeca 100644
--- a/tools/flask/policy/modules/modules.conf
+++ b/tools/flask/policy/modules/modules.conf
@@ -56,3 +56,5 @@ vm_role = on
 ndvm = on
 # UI VM
 uivm = on
+# Synchronizer VM
+syncvm = on
diff --git a/tools/flask/policy/modules/syncvm.te b/tools/flask/policy/modules/syncvm.te
new file mode 100644
index 0000000000..1a9c051972
--- /dev/null
+++ b/tools/flask/policy/modules/syncvm.te
@@ -0,0 +1,10 @@
+declare_domain(syncvm_t)
+create_domain(dom0_t, syncvm_t)
+manage_domain(dom0_t, syncvm_t)
+blktap_disk(syncvm_t, dom0_t)
+domain_self_comms(syncvm_t)
+
+# Both of these domain types can be created using the default (system) role
+role system_r types { syncvm_t };
+
+argo_comms(dom0_t, syncvm_t)
-- 
2.21.0

